{"version":3,"sources":["../../src/services/itemLookUp.js"],"names":["itemLookUp","uri","Promise","resolve","reject","search","productId","split","err","res","html","$","load","result","item","find","imageURL","attr","title","link","sellStepOne","sellStepTwo","priceElm","whole","fact","price","Number","seller"],"mappings":";;;;;QAQgBA,U,GAAAA,U;;AARhB;;;;AACA;;;;;;AAEA;AACA;AACA;AACA;;AAEO,SAASA,UAAT,CAAoBC,GAApB,EAAwB;AAC7B,SAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,QAAG,CAACH,GAAJ,EAAS,OAAOG,OAAO,qBAAP,CAAP;AACT,QAAGH,IAAII,MAAJ,CAAW,KAAX,IAAoB,CAAvB,EAA0B,OAAOD,OAAO,qBAAP,CAAP;AAC1B,QAAIE,YAAY,OAAOL,IAAIM,KAAJ,CAAU,KAAV,EAAiB,CAAjB,EAAoBA,KAApB,CAA0B,GAA1B,EAA+B,CAA/B,CAAvB;AACA;AACA,wEAAmDD,SAAnD,EAAgE,UAACE,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC5E,UAAGF,OAAM,CAACC,GAAP,IAAc,CAACC,IAAlB,EAAwB,OAAON,OAAO,WAAP,CAAP;AACxB;AACA,UAAIO,IAAI,kBAAQC,IAAR,CAAaF,IAAb,CAAR;AACA,UAAIG,SAAS,EAAb;AACA,UAAIC,OAAOH,EAAE,qBAAF,EAAyBI,IAAzB,oBAA+CT,SAA/C,QAAX;AACAO,aAAOG,QAAP,GAAkBL,EAAEG,IAAF,EAAQC,IAAR,CAAa,mCAAb,EAAkDA,IAAlD,CAAuD,iBAAvD,EAA0EE,IAA1E,CAA+E,KAA/E,CAAlB;AACAJ,aAAOK,KAAP,GAAeP,EAAEG,IAAF,EAAQC,IAAR,CAAa,mCAAb,EAAkDA,IAAlD,CAAuD,iBAAvD,EAA0EE,IAA1E,CAA+E,KAA/E,CAAf;AACAJ,aAAOM,IAAP,GAAcR,EAAEG,IAAF,EAAQC,IAAR,CAAa,mCAAb,EAAkDA,IAAlD,CAAuD,gBAAvD,EAAyEE,IAAzE,CAA8E,MAA9E,CAAd;AACA,UAAIG,cAAcT,EAAEG,IAAF,EAAQC,IAAR,CAAa,oCAAb,EAAmDA,IAAnD,CAAwD,uBAAxD,EAAiF,GAAjF,CAAlB;AACA,UAAIM,cAAcV,EAAES,WAAF,EAAeL,IAAf,CAAoB,qCAApB,EAA2D,GAA3D,CAAlB;AACA,UAAIO,WAAWX,EAAEG,IAAF,EAAQC,IAAR,CAAa,0BAAb,CAAf;AACA,UAAIQ,QAAQZ,EAAEW,QAAF,EAAYP,IAAZ,CAAiB,iBAAjB,EAAoCL,IAApC,EAAZ;AACA,UAAIc,OAAOb,EAAEW,QAAF,EAAYP,IAAZ,CAAiB,sBAAjB,EAAyCL,IAAzC,EAAX;AACAG,aAAOY,KAAP,GAAeC,OAAOH,KAAP,IAAgB,OAAOG,OAAOF,IAAP,CAAtC;AACAX,aAAOc,MAAP,GAAgBhB,EAAEU,WAAF,EAAeX,IAAf,EAAhB;AACAG,aAAOP,SAAP,GAAmBA,SAAnB;AACA;AACA;AACA;AACA;AACA,UAAG,CAACO,OAAOP,SAAR,IAAqB,CAACO,OAAOG,QAAhC,EAA0C,OAAOZ,OAAO,uCAAP,CAAP;AAC1CD,cAAQU,MAAR;AACH,KAvBL;AAwBC,GA7BI,CAAP;AA8BD","file":"itemLookUp.js","sourcesContent":["import cheerio from 'cheerio';\nimport request from 'request';\n\n// itemLookUp('https://www.amazon.com/Drive-Converter-FIDECO-Adapter-External/dp/B077N2KK27/ref=sr_1_1?ie=UTF8&qid=1518249729&sr=8-1&keywords=B077N2KK27')\n//   .then(product=>{\n//     console.log(product)\n//   }).catch(e=>console.log(e));\n\nexport function itemLookUp(uri){\n  return new Promise((resolve, reject) => {\n    if(!uri) return reject('No Uri Is Provided.')\n    if(uri.search('/B0') < 0) return reject('No Product Id Found');\n    let productId = 'B0' + uri.split('/B0')[1].split('/')[0];\n    // let momentStarting = new Date();\n    request(`https://www.amazon.com/s/field-keywords=${productId}`, (err, res, html) => {\n            if(err|| !res || !html) return reject('500:Error');\n            // console.log('htmllll', html);\n            let $ = cheerio.load(html);\n            let result = {};\n            let item = $('#s-results-list-atf').find(`li[data-asin=\"${productId}\"]`);\n            result.imageURL = $(item).find('.a-fixed-left-grid-col.a-col-left').find('.s-access-image').attr('src');\n            result.title = $(item).find('.a-fixed-left-grid-col.a-col-left').find('.s-access-image').attr('alt');\n            result.link = $(item).find('.a-fixed-left-grid-col.a-col-left').find('.a-link-normal').attr('href');\n            let sellStepOne = $(item).find('.a-fixed-left-grid-col.a-col-right').find('.a-row.a-spacing-none')['1'];\n            let sellStepTwo = $(sellStepOne).find('span.a-size-small.a-color-secondary')['1']\n            let priceElm = $(item).find('.sx-price.sx-price-large');\n            let whole = $(priceElm).find('.sx-price-whole').html()\n            let fact = $(priceElm).find('.sx-price-fractional').html()\n            result.price = Number(whole) + 0.01 * Number(fact);\n            result.seller = $(sellStepTwo).html();\n            result.productId = productId;\n            // const momentEnding = new Date()\n            // const period = momentEnding.getTime() - momentStarting.getTime() + ' ms';\n            // console.log('period: ', period)\n            // console.log(result);\n            if(!result.productId || !result.imageURL) return reject('400:Item Information is not complete.');\n            resolve(result);\n        })\n    })\n}"]}